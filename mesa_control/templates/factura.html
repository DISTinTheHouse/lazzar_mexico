{% extends 'layouts/layout.html' %}
{% block title %}
    {{title}}
{% endblock %}
{% block content %}

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SP1MJ3P87D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SP1MJ3P87D');
</script>

<style>
  .icon-above-text {
    align-items: center; 
    text-align: center; 
  }

  .icon-above-text .material-icons {
    margin-bottom: 1px; 
  }
  .btn{
    display: flex;
    align-items: center;
  }
  .material-icons-round{
    margin-right: 5px;
  }
</style>
<h1 class="text-center display-1 fw-bold title" style="background-color: #2586a6; color: #f8f7f6; font-weight: bold; text-shadow: 3px 3px 4px rgba(0, 0, 0, 0.7); padding: 5px;">Estatus de pedidos</h1>
<p class="display-4 text-left fw-bold text-center title subtitulos" style="color: #fccc0a; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.3); padding: 15px; background: linear-gradient(to bottom, #2586a6, #f8f7f6);">  Facturación</p>

<main class="container-fluid mt-2">

  <section style="padding: 15px; display: flex; justify-content: center; align-items: center; padding: 25px; background-color: #f8f7f6;">
    <ul class="nav nav-tabs flex-column flex-sm-row mx-auto" id="ex-with-icons" role="tablist">
        <li class="nav-item" role="presentation">
         <a class="nav-link " aria-current="page" href="http://bodegalazzar.ddns.net:3000/envios" style="color: #6c8ead; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
           <div class="d-flex flex-column icon-above-text">
             <span class="material-symbols-outlined" style="font-size: 35px;">local_shipping</span>
             Rastreo Lazzar
           </div>
         </a>
       </li>
      <li class="nav-item" role="presentation">
        <a class="nav-link " aria-current="page" href="{% url 'pedidos-activos' %}" style="color: #087e8b; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-rounded" style="font-size: 35px;">fast_forward</span>
            Pedidos Activos
          </div>
        </a>
      </li>
      <!--<li class="nav-item">
        <a class="nav-link " aria-current="page" href="{% url 'procesos' %}" style="color: #5DADE2; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1);"">
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-rounded">running_with_errors</span>
            Procesos
          </div>
        </a>
      </li> -->
      <li class="nav-item">
        <a class="nav-link " aria-current="page" href="{% url 'vencidos' %}" style="color: #f82f2f; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-rounded" style="font-size: 35px;">gpp_bad</span>
            Pedidos Vencidos
          </div>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link " aria-current="page" href="{% url 'vencidos_semana' %}" style="color: #fb8b24; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-rounded" style="font-size: 35px;">quick_reference</span>
            Prox. A Vencer
          </div>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link " aria-current="page" href="{% url 'dashboard' %}" style="color: #ffc354; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-rounded" style="font-size: 35px;">donut_small</span>
            Dashboard
          </div>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" aria-current="page" href="{% url 'factura' %}" style="color: #07bca7; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-outlined" style="font-size: 35px;">task</span>
            Facturación
          </div>
        </a>
      </li>
      <!--<li class="nav-item">
        <a class="nav-link " aria-current="page" href="{% url 'search_pedido' %}" style="color: #0B2265; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1);" >
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-outlined">manage_search</span>
            Buscar Pedido
          </div>
        </a>
      </li> -->
        <li class="nav-item">
            <a class="nav-link " aria-current="page" href="{% url 'programacion' %}" style="color: #0b2265; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
              <div class="d-flex flex-column icon-above-text">
                <span class="material-symbols-outlined" style="font-size: 35px;">edit_calendar</span>
                Programación
              </div>
            </a>
        </li>
        <li class="nav-item" role="presentation">
        <a class="nav-link " aria-current="page" href="{% url 'muestras' %}" style="color: #345995; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-rounded" style="font-size: 35px;">shopping_cart_checkout</span>
            Muestras
          </div>
        </a>
        </li>
      <li class="nav-item">
        <a class="nav-link " download="Existencias.xlsx" aria-current="page" href="https://www.lazzarmexico.com/archivos/existencias/Existencias_Lazzar.xlsx" style="color: #00a9db; font-weight: bold; text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.1); font-size: 16px;">
          <div class="d-flex flex-column icon-above-text">
            <span class="material-symbols-outlined" style="font-size: 35px;">download</span>
            Existencias
          </div>
        </a>
      </li>
    </ul>
  </div>
</section>

<div class="row justify-content-center"> <!-- Se reemplaza box-->
  <div class="col-sm-8 col-md-6 col-lg-4 mt-3 text-center" style="border:solid 9px #82E0AA; padding: 15px; border-radius: 30px; box-shadow:0 10px 20px rgba(0, 0, 0, 0.5);">
    
    <form action="{% url 'factura' %}" method="POST" class="card card-body text-center mt-5" style="border:solid 6px #EAECEE; border-radius: 30px; margin-bottom: 25px;">
    {% csrf_token %}
    
    <label for="title" style="color: #808B96;">Fecha :</label>
    <input type="date"  name="start_date" style="border:solid 3px #ABB2B9; padding: 5px; border-radius: 15px; color: #82E0AA;"/>

    <label for="content" style="color: #808B96;">A la Fecha:</label>
    <input type="date" name="end_date" style="border:solid 3px #ABB2B9; padding: 5px; border-radius: 15px; color: #82E0AA;"/>

    <hr>

    <button type="submit button" class="btn btn-success pd-3 justify-content-center" value="buscar" style="border-radius: 15px; ">
      <span class="material-symbols-rounded">manage_search</span>
      BUSCAR
    </button>
    </form>
  </div>
</div>

<div class="d-flex justify-content-center align-items-center mt-4 mb-4" >
  <a href="{% url 'factura_pedido' %}" target="_blank" class="btn btn-warning" style="border:solid 8px #F9E79F; padding: 15px; border-radius: 30px; box-shadow:0 10px 20px rgba(0, 0, 0, 0.5); text-decoration-color: #DC7633; margin-right: 1rem;">Encuentra Factura Por Pedido</a>
  <a href="{% url 'embarque_pedido' %}" target="_blank" class="btn btn-danger" style="border:solid 8px #E6B0AA; padding: 15px; border-radius: 30px; box-shadow:0 10px 20px rgba(0, 0, 0, 0.5); text-decoration-color: #DC7633;">Encuentra Embarque Por Pedido</a>
</div>

      {% if leyenda and resultado %}

<div class="form-outline mb-4 mt-1">
  <input type="text" class="form-control form-control-lg" id="datatable-search-input" placeholder="Buscar Consulta. . ." style="border:solid 6px #82E0AA; box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3); border-radius: 25px;"/>
  <label class="form-label" for="datatable-search-input"></label>
</div>

</main>
<div class="container-fluid">

        <table class="table table-striped table-borderless table-sm table-hover table-secondary table-responsive mt-2" style="border:solid 10px #82E0AA; box-shadow: 0 10px 10px rgba(0, 0, 0, 0.5);">
          <thead class="table-success table-fixed" style="position: sticky; top: 0; z-index: 1000;">
            <tr>
              <th class="text-center">PEDIDO</th>
              <th class="text-center">FACTURA</th>
              <th class="text-center">TOTAL</th>
              <th class="text-center">CLIENTE</th>
              <th class="text-center">VENDEDOR</th>
              <th class="text-center">DETALLE</th>
            </tr>
          </thead>
          <tbody>
            {% for fila in resultado %}
            <tr>
              <td class="text-center" style="font-weight: bold;">{{ fila.0 }}</td>
              <td class="text-center">{{ fila.1 }}</td>
              <td class="text-center" style="font-weight: bold;">${{ fila.2|floatformat:2 }}</td>
              <td class="text-center" style="font-style: italic;">{{ fila.3 }}</td>
              <td class="text-center">{{ fila.4 }}</td>
              <td class="text-center">
                <form id="myForm" method="POST" action="{% url 'detalle_factura' %}">
                  {% csrf_token %}
                  <input type="hidden" name="variable" value="{{ fila.0 }}">
                <button type="submit" class="btn btn-success" style="border-radius: 25px;">
                  <span class="material-symbols-rounded">data_info_alert</span>
                    Detalle
                </button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endif %}
    </div>
  </div>


  

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    $('#datatable-search-input').on('input', function() {
      var searchText = $(this).val().toLowerCase();
      $('#datatable tbody tr').each(function() {
        var rowText = $(this).text().toLowerCase();
        if (rowText.indexOf(searchText) === -1) {
          $(this).hide();
        } else {
          $(this).show();
        }
      });
    });
  });
  // Preload
const loader = document.querySelector(".loader");

// Mostrar el preload al hacer clic en un enlace, excluyendo elementos dentro de la barra de navegación
document.addEventListener("click", (event) => {
  const target = event.target;

  // Verificar si el elemento clickeado es un enlace o parte del menú desplegable
  const isLink = target.tagName === "A";
  const isDropdownItem = target.classList.contains("dropdown-item");

  // Verificar si el elemento clickeado o sus ancestros contienen una clase específica
  // que identifique la barra de navegación (en este caso, usaremos "navbar-nav")
  const isNavbarItem = target.closest(".navbar-nav");

  // Si el elemento clickeado es un enlace, no es parte del menú desplegable,
  // y no se encuentra dentro de la barra de navegación, mostrar preload
  if (isLink && !isDropdownItem && !isNavbarItem) {
    loader.classList.remove("loader-hidden");
  }
});

// Ocultar el preload una vez que la página haya cargado completamente
window.addEventListener("load", () => {
  loader.classList.add("loader-hidden");
});
</script>


<footer class=" text-center mt-4" style="background-color: #f2f2f2;">
  <div class="row">

    <section style="padding: 23px;" class="titulos">
      © 2023 Copyright:
      <a style="color: #B7950B; text-decoration:underline;" href="https://www.lazzarmexico.com/" class="titulos">Lazzarmexico.com</a>
      
    </section>

  <div class="text-center titulos p-4 larger-text" style="background-color: rgba(11, 34, 101); font-size: 18px; background: linear-gradient(to top, #0B2265, #2586a6);">
      <p style="color: azure;">
          Respeto, Honestidad, Confianza, Responsabilidad, Lealtad
      </p>
  </div>
</footer>
{% endblock %}